{
  "version": 3,
  "sources": ["../../@hmans/event/dist/hmans-event.esm.js", "../../@miniplex/bucket/dist/miniplex-bucket.esm.js", "../../@miniplex/core/dist/miniplex-core.esm.js"],
  "sourcesContent": ["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar Event = /*#__PURE__*/function () {\n  function Event() {\n    _classCallCheck(this, Event);\n\n    _defineProperty(this, \"listeners\", new Set());\n\n    this.emit = this.emit.bind(this);\n  }\n\n  _createClass(Event, [{\n    key: \"clear\",\n    value: function clear() {\n      this.listeners.clear();\n    }\n  }, {\n    key: \"add\",\n    value: function add(listener) {\n      var _this = this;\n\n      this.listeners.add(listener);\n      return function () {\n        return _this.remove(listener);\n      };\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(listener) {\n      this.listeners[\"delete\"](listener);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(payload) {\n      var _iterator = _createForOfIteratorHelper(this.listeners),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var listener = _step.value;\n          listener(payload);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }]);\n\n  return Event;\n}();\n\nexport { Event };\n", "import { Event } from '@hmans/event';\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function () {};\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nvar _Symbol$iterator;\n\n/**\n * A class wrapping an array of entities of a specific type, providing\n * performance-optimized methods for adding and removing entities, and events\n * for when entities are added or removed.\n */\n_Symbol$iterator = Symbol.iterator;\nvar Bucket = /*#__PURE__*/function () {\n  function Bucket() {\n    var entities = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    _classCallCheck(this, Bucket);\n    _defineProperty(this, \"onEntityAdded\", new Event());\n    _defineProperty(this, \"onEntityRemoved\", new Event());\n    _defineProperty(this, \"entityPositions\", new Map());\n    this.entities = entities;\n    this.add = this.add.bind(this);\n    this.remove = this.remove.bind(this);\n\n    /* Register all entity positions */\n    for (var i = 0; i < entities.length; i++) {\n      this.entityPositions.set(entities[i], i);\n    }\n  }\n\n  /**\n   * Fired when an entity has been added to the bucket.\n   */\n  _createClass(Bucket, [{\n    key: _Symbol$iterator,\n    value: /* Custom iterator that iterates over all entities in reverse order. */\n    function value() {\n      var _this = this;\n      var index = this.entities.length;\n      return {\n        next: function next() {\n          var value = _this.entities[--index];\n          return {\n            value: value,\n            done: index < 0\n          };\n        }\n      };\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return this.entities.length;\n    }\n  }, {\n    key: \"has\",\n    value: function has(entity) {\n      return this.entityPositions.has(entity);\n    }\n  }, {\n    key: \"add\",\n    value: function add(entity) {\n      if (entity && !this.has(entity)) {\n        this.entities.push(entity);\n        this.entityPositions.set(entity, this.entities.length - 1);\n\n        /* Emit our own onEntityAdded event */\n        this.onEntityAdded.emit(entity);\n      }\n      return entity;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(entity) {\n      if (this.has(entity)) {\n        /* Emit our own onEntityRemoved event. */\n        this.onEntityRemoved.emit(entity);\n\n        /* Get the entity's current position. */\n        var index = this.entityPositions.get(entity);\n        this.entityPositions[\"delete\"](entity);\n\n        /* Perform shuffle-pop if there is more than one entity. */\n        var other = this.entities[this.entities.length - 1];\n        if (other !== entity) {\n          this.entities[index] = other;\n          this.entityPositions.set(other, index);\n        }\n\n        /* Remove the entity from the entities array. */\n        this.entities.pop();\n      }\n      return entity;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var _iterator = _createForOfIteratorHelper(this),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var entity = _step.value;\n          this.remove(entity);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }]);\n  return Bucket;\n}();\n\nexport { Bucket };\n", "import { Bucket } from '@miniplex/bucket';\nexport * from '@miniplex/bucket';\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function () {};\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nvar Memoizer = /*#__PURE__*/function () {\n  function Memoizer() {\n    _classCallCheck(this, Memoizer);\n    _defineProperty(this, \"cache\", new Map());\n  }\n  _createClass(Memoizer, [{\n    key: \"get\",\n    value: function get(key, predicate) {\n      var value = this.cache.get(key);\n      if (value === undefined) {\n        this.cache.set(key, predicate);\n        value = predicate;\n      }\n      return value;\n    }\n  }]);\n  return Memoizer;\n}();\n\nfunction isArchetype(entity) {\n  for (var _len = arguments.length, components = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    components[_key - 1] = arguments[_key];\n  }\n  return hasComponents.apply(void 0, [entity].concat(components));\n}\nfunction hasComponents(entity) {\n  for (var _len2 = arguments.length, components = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    components[_key2 - 1] = arguments[_key2];\n  }\n  return components.every(function (c) {\n    return entity[c] !== undefined;\n  });\n}\nfunction hasAnyComponents(entity) {\n  for (var _len3 = arguments.length, components = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    components[_key3 - 1] = arguments[_key3];\n  }\n  return components.some(function (c) {\n    return entity[c] !== undefined;\n  });\n}\nfunction hasNoComponents(entity) {\n  for (var _len4 = arguments.length, components = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    components[_key4 - 1] = arguments[_key4];\n  }\n  return components.every(function (c) {\n    return entity[c] === undefined;\n  });\n}\n\n/* not */\n\nvar notCache = new Memoizer();\nvar not = function not(predicate) {\n  return notCache.get(predicate, function (entity) {\n    return !predicate(entity);\n  });\n};\n\nvar normalizeComponents = function normalizeComponents(components) {\n  return _toConsumableArray(new Set(components.sort().filter(function (c) {\n    return !!c && c !== \"\";\n  })));\n};\n\n/* Archetype Queries */\n\nvar normalizeQuery = function normalizeQuery(query) {\n  return {\n    \"with\": query[\"with\"] !== undefined ? normalizeComponents(query[\"with\"]) : [],\n    without: query.without !== undefined ? normalizeComponents(query.without) : []\n  };\n};\nvar queryCache = new Memoizer();\nvar memoizeQuery = function memoizeQuery(query) {\n  var normalizedQuery = normalizeQuery(query);\n  var key = JSON.stringify(normalizedQuery);\n  return queryCache.get(key, normalizedQuery);\n};\n\n/**\n * An entity-aware bucket providing methods for creating\n * derived buckets, and tracking the buckets derived from it.\n */\nvar EntityBucket = /*#__PURE__*/function (_Bucket) {\n  _inherits(EntityBucket, _Bucket);\n  var _super = _createSuper(EntityBucket);\n  function EntityBucket() {\n    var _this;\n    _classCallCheck(this, EntityBucket);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"buckets\", new Set());\n    return _this;\n  }\n  _createClass(EntityBucket, [{\n    key: \"wants\",\n    value:\n    /**\n     * Returns `true` if the given entity should be in this bucket. Child classes\n     * should override this method to implement custom bucket logic.\n     *\n     * @param entity The entity to check for.\n     * @returns `true` if this bucket wants the specified entity, `false` otherwise.\n     */\n    function wants(entity) {\n      return true;\n    }\n\n    /**\n     * Evaluates the given entity (`entity`) to check if it should be in this bucket or not.\n     * The entity will be added or removed from this bucket as necessary.\n     *\n     * If you pass a second argument (`future`) into this function, it will be used\n     * for these checks instead of the entity itself. This is useful in sutations\n     * where you're about to make a destructive change to the entity, and want to\n     * give archetype callbacks a chance to run with the entity intact before actually\n     * making the change.\n     *\n     * @param entity The entity that is being evaluated.\n     * @param future An optional future version of the entity that is used in the check.\n     */\n  }, {\n    key: \"evaluate\",\n    value: function evaluate(entity) {\n      var future = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : entity;\n      /* Accept or reject the entity */\n      if (this.wants(future)) {\n        this.add(entity);\n      } else {\n        this.remove(entity);\n      }\n\n      /* If the entity is still in this bucket, update derived buckets. */\n      if (this.has(entity)) {\n        var _iterator = _createForOfIteratorHelper(this.buckets),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var bucket = _step.value;\n            bucket.evaluate(entity, future);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    }\n  }, {\n    key: \"where\",\n    value: function where(predicate) {\n      var _this2 = this;\n      var index = this.entities.length;\n      var next = function next() {\n        var value;\n        do {\n          value = _this2.entities[--index];\n        } while (value && !predicate(value));\n        return {\n          value: value,\n          done: index < 0\n        };\n      };\n      return _defineProperty({}, Symbol.iterator, function () {\n        return {\n          next: next\n        };\n      });\n    }\n\n    /* with */\n  }, {\n    key: \"with\",\n    value: function _with() {\n      return this.archetype.apply(this, arguments);\n    }\n\n    /* without */\n  }, {\n    key: \"without\",\n    value: function without() {\n      for (var _len2 = arguments.length, props = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        props[_key2] = arguments[_key2];\n      }\n      return this.archetype({\n        without: props\n      });\n    }\n\n    /* Predicate form */\n  }, {\n    key: \"archetype\",\n    value: /* Implementation */\n\n    function archetype(query) {\n      /* Handle the function form */\n      if (typeof query === \"function\") {\n        var _iterator2 = _createForOfIteratorHelper(this.buckets),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _bucket2 = _step2.value;\n            if (_bucket2 instanceof PredicateBucket && _bucket2.predicate === query) {\n              return _bucket2;\n            }\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        var _bucket = new PredicateBucket(this, query);\n        this.buckets.add(_bucket);\n        return _bucket;\n      }\n\n      /* Handle the string form */\n      if (_typeof(query) !== \"object\") {\n        for (var _len3 = arguments.length, rest = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n          rest[_key3 - 1] = arguments[_key3];\n        }\n        return this.archetype({\n          \"with\": [query].concat(rest)\n        });\n      }\n\n      /* Find and return existing archetype bucket */\n      var memoizedQuery = memoizeQuery(query);\n      var _iterator3 = _createForOfIteratorHelper(this.buckets),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var _bucket3 = _step3.value;\n          if (_bucket3 instanceof ArchetypeBucket && _bucket3.query === memoizedQuery) {\n            return _bucket3;\n          }\n        }\n\n        /* Create a new bucket */\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n      var bucket = new ArchetypeBucket(this, memoizedQuery);\n      this.buckets.add(bucket);\n      return bucket;\n    }\n  }]);\n  return EntityBucket;\n}(Bucket);\nvar DerivedEntityBucket = /*#__PURE__*/function (_EntityBucket) {\n  _inherits(DerivedEntityBucket, _EntityBucket);\n  var _super2 = _createSuper(DerivedEntityBucket);\n  function DerivedEntityBucket(source) {\n    var _this3;\n    _classCallCheck(this, DerivedEntityBucket);\n    _this3 = _super2.call(this);\n    _this3.source = source;\n    return _this3;\n  }\n  _createClass(DerivedEntityBucket, [{\n    key: \"startUpdating\",\n    value: function startUpdating() {\n      var _this4 = this;\n      this.source.onEntityAdded.add(function (e) {\n        if (_this4.wants(e)) _this4.add(e);\n      });\n      this.source.onEntityRemoved.add(function (e) {\n        _this4.remove(e);\n      });\n      this.update();\n    }\n\n    /**\n     * Updates the contents of this bucket by iterating over the entities\n     * in its source bucket, re-checking each one to see if it should be\n     * in this bucket or not.\n     */\n  }, {\n    key: \"update\",\n    value: function update() {\n      var _iterator4 = _createForOfIteratorHelper(this.source),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var entity = _step4.value;\n          this.evaluate(entity);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }]);\n  return DerivedEntityBucket;\n}(EntityBucket);\n\n/**\n * A bucket representing a subset of entities that satisfy\n * a given predicate.\n */\nvar PredicateBucket = /*#__PURE__*/function (_DerivedEntityBucket) {\n  _inherits(PredicateBucket, _DerivedEntityBucket);\n  var _super3 = _createSuper(PredicateBucket);\n  function PredicateBucket(source, predicate) {\n    var _this5;\n    _classCallCheck(this, PredicateBucket);\n    _this5 = _super3.call(this, source);\n    _this5.source = source;\n    _this5.predicate = predicate;\n    _this5.startUpdating();\n    return _this5;\n  }\n  _createClass(PredicateBucket, [{\n    key: \"wants\",\n    value: function wants(entity) {\n      return this.predicate(entity);\n    }\n  }]);\n  return PredicateBucket;\n}(DerivedEntityBucket);\n\n/**\n * A bucket representing a subset of entities that have a\n * specific set of components.\n */\nvar ArchetypeBucket = /*#__PURE__*/function (_DerivedEntityBucket2) {\n  _inherits(ArchetypeBucket, _DerivedEntityBucket2);\n  var _super4 = _createSuper(ArchetypeBucket);\n  function ArchetypeBucket(source, query) {\n    var _this6;\n    _classCallCheck(this, ArchetypeBucket);\n    _this6 = _super4.call(this, source);\n    _this6.source = source;\n    _this6.query = query;\n    _this6.startUpdating();\n    return _this6;\n  }\n  _createClass(ArchetypeBucket, [{\n    key: \"wants\",\n    value: function wants(entity) {\n      return hasComponents.apply(void 0, [entity].concat(_toConsumableArray(this.query[\"with\"] || []))) && hasNoComponents.apply(void 0, [entity].concat(_toConsumableArray(this.query.without || [])));\n    }\n  }]);\n  return ArchetypeBucket;\n}(DerivedEntityBucket);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n\nvar World = /*#__PURE__*/function (_EntityBucket) {\n  _inherits(World, _EntityBucket);\n  var _super = _createSuper(World);\n  function World() {\n    var _this;\n    var entities = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    _classCallCheck(this, World);\n    _this = _super.call(this, entities);\n\n    /* When entities are removed, also make sure to forget about their IDs. */\n    _defineProperty(_assertThisInitialized(_this), \"entityToId\", new Map());\n    _defineProperty(_assertThisInitialized(_this), \"idToEntity\", new Map());\n    _defineProperty(_assertThisInitialized(_this), \"nextId\", 0);\n    _this.onEntityRemoved.add(function (entity) {\n      /* Remove the entity from the ID map */\n      if (_this.entityToId.has(entity)) {\n        var id = _this.entityToId.get(entity);\n        _this.idToEntity[\"delete\"](id);\n        _this.entityToId[\"delete\"](entity);\n      }\n    });\n    return _this;\n  }\n  _createClass(World, [{\n    key: \"update\",\n    value: function (_update) {\n      function update(_x, _x2, _x3) {\n        return _update.apply(this, arguments);\n      }\n      update.toString = function () {\n        return _update.toString();\n      };\n      return update;\n    }(function (entity, update, value) {\n      if (typeof update === \"function\") {\n        var partial = update(entity);\n        partial && Object.assign(entity, partial);\n      } else if (typeof update === \"string\") {\n        entity[update] = value;\n      } else if (update) {\n        Object.assign(entity, update);\n      }\n\n      /* If this world knows about the entity, notify any derived buckets about the change. */\n      if (this.has(entity)) {\n        this.evaluate(entity);\n      }\n      return entity;\n    })\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(entity, component, value) {\n      /* Return early if the entity already has the component. */\n      if (entity[component] !== undefined) return;\n\n      /* Set the component */\n      entity[component] = value;\n\n      /* Touch the entity, triggering re-checks of indices */\n      if (this.has(entity)) {\n        this.evaluate(entity);\n      }\n    }\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(entity, component) {\n      /* Return early if the entity doesn't even have the component. */\n      if (entity[component] === undefined) return;\n\n      /* If this world knows about the entity, notify any derived buckets about the change. */\n      if (this.has(entity)) {\n        var future = _objectSpread2({}, entity);\n        delete future[component];\n        this.evaluate(entity, future);\n      }\n\n      /* Remove the component. */\n      delete entity[component];\n    }\n\n    /* IDs */\n  }, {\n    key: \"id\",\n    value: function id(entity) {\n      /* We only ever want to generate IDs for entities that are actually in the world. */\n      if (!this.has(entity)) return undefined;\n\n      /* Lazily generate an ID. */\n      if (!this.entityToId.has(entity)) {\n        var id = this.nextId++;\n        this.entityToId.set(entity, id);\n        this.idToEntity.set(id, entity);\n      }\n      return this.entityToId.get(entity);\n    }\n  }, {\n    key: \"entity\",\n    value: function entity(id) {\n      return this.idToEntity.get(id);\n    }\n  }]);\n  return World;\n}(EntityBucket);\n\nexport { ArchetypeBucket, DerivedEntityBucket, EntityBucket, PredicateBucket, World, hasAnyComponents, hasComponents, hasNoComponents, isArchetype, memoizeQuery, normalizeComponents, normalizeQuery, not };\n"],
  "mappings": "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",
  "names": ["Event", "_arrayLikeToArray", "_unsupportedIterableToArray", "_createForOfIteratorHelper", "_classCallCheck", "_defineProperties", "_createClass", "_defineProperty", "Bucket", "value", "_arrayLikeToArray", "_unsupportedIterableToArray", "obj", "_createForOfIteratorHelper", "_classCallCheck", "_defineProperties", "_createClass", "_setPrototypeOf", "o", "p", "_getPrototypeOf", "_defineProperty", "Memoizer", "not", "normalizeComponents", "normalizeQuery", "memoizeQuery", "EntityBucket", "next", "DerivedEntityBucket", "PredicateBucket", "ArchetypeBucket", "World", "id"]
}
